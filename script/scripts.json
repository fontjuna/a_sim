{
    "is_price_breakout": {
        "script": "# 가격 신고가/신저가 돌파 확인\ndy = ChartManager('dy')\n\n# 기본값으로 방향(상향/하향)과 기간 설정\ndirection = kwargs.get('direction', 'up')\nperiod = kwargs.get('period', 20)\n\n# 기준값 계산\nif direction == 'up':\n    threshold = dy.highest(code, dy.h, period, 1)  # 이전 고점\n    current = dy.c(code)  # 현재가\n    return current > threshold  # 상향 돌파\nelse:\n    threshold = dy.lowest(code, dy.l, period, 1)  # 이전 저점\n    current = dy.c(code)  # 현재가\n    return current < threshold  # 하향 돌파",
        "vars": {},
        "type": "bool",
        "desc": ""
    },
    "band_break_down": {
        "script": "# 볼린저 밴드 돌파 전략\ndy = ChartManager('dy')  # 일봉\n\n# 볼린저 밴드 계산 (20일, 2표준편차)\nupper, middle, lower = dy.bollinger_bands(code, 20, 2)\n\n# 전일 종가와 밴드 관계\nprev_close = dy.c(code, 1)\nprev_above_upper = prev_close > upper\n\n# 현재 종가와 밴드 관계\ncurr_close = dy.c(code)\ncurr_below_upper = curr_close < upper\n\n# 밴드 상단 아래로 꺾기 확인\nband_break_down = prev_above_upper and curr_below_upper\n\n# 결과 반환\nresult = band_break_down",
        "vars": {},
        "type": "bool_",
        "desc": ""
    },
    "is_golden_cross": {
        "script": "# 골든 크로스 전략\ndy = ChartManager('dy')  # 일봉\n\n# 단기/장기 이동평균\nshort_ma = dy.ma(code, dy.c, 5)  # 5일 단순이동평균\nlong_ma = dy.ma(code, dy.c, 20)  # 20일 단순이동평균\n\n# 골든 크로스 확인\nis_golden_cross = dy.cross_up(code, \n    lambda c, n: dy.ma(c, dy.c, 5, n), \n    lambda c, n: dy.ma(c, dy.c, 20, n))\n\n# 거래량 확인 (평균 대비 1.5배 이상)\nvolume_increase = dy.v(code) > dy.avg(code, dy.v, 5) * 1.5\n\n# 결과 반환: 골든크로스 + 거래량 증가\nresult = is_golden_cross and volume_increase",
        "vars": {},
        "type": "bool",
        "desc": "골든 전략"
    },
    "highest_close_in_10_days": {
        "script": "dy = ChartManager('dy')  # 일봉\nmax_high = 0\nmax_high_idx = -1\n\n# loop 함수를 사용하여 최근 10개 봉 확인\n# def 키워드 사용 불가, 람다 함수 사용\ncheck_high = lambda i: dy.h(code, i)\n\nhigh_prices = loop(range(10), check_high)\nmax_high = max(high_prices)\nmax_high_idx = high_prices.index(max_high)\n\n# 현재가 계산\ncurrent_price = dy.c(code, 0)\ndrop_pct = ((max_high - current_price) / max_high) * 100 if max_high > 0 else 0\n\n# 결과 반환\nresult = drop_pct >= 10  # 최고가 대비 10% 이상 하락",
        "vars": {},
        "type": "bool",
        "desc": "최근 10개봉중 최고가 찾기"
    },
    "test": {
        "script": "dy = ChartManager('dy')\nresult = dy.c(code, 0)",
        "vars": {},
        "type": "int",
        "desc": ""
    },
    "test2": {
        "script": "dy = ChartManager('dy')\nmi1 = ChartManager('mi', 1)\ndata = mi1.chart_data._data[code]['mi1'][0]\ndebug(data)\nresult = (dy.c(code) < 55750, dy.c(code),)",
        "vars": {},
        "type": "tuple",
        "desc": ""
    },
    "macd_diversions": {
        "script": "# MACD 다이버전스 검출\ndy = ChartManager('dy')\n# MACD 계산\nfast = kwargs.get('fast', 12)\nslow = kwargs.get('slow', 26)\nsignal = kwargs.get('signal', 9)\nlookback = kwargs.get('lookback', 20)\n# 가격 패턴과 MACD 패턴 분석\nprice_lows = []\nmacd_lows = []\n# 최근 N봉 검사\nfor i in range(lookback):\n    # 저점 판별 (전봉과 다음봉보다 낮은지)\n    if i > 0 and i < lookback-1:\n        if dy.l(code, i) < dy.l(code, i-1) and dy.l(code, i) < dy.l(code, i+1):\n            price_lows.append((i, dy.l(code, i)))\n            \n            # 해당 시점의 MACD 값\n            macd_val = dy.macd(code, fast, slow, signal, i)[0]\n            macd_lows.append((i, macd_val))\n# 다이버전스 확인 (최소 2개 이상의 저점 필요)\nhas_divergence = False\nif len(price_lows) >= 2 and len(macd_lows) >= 2:\n    # 가격은 하락 저점, MACD는 상승 저점인지 확인\n    if price_lows[-1][1] < price_lows[-2][1] and macd_lows[-1][1] > macd_lows[-2][1]:\n        has_divergence = True\nresult = has_divergence",
        "vars": {},
        "type": "bool",
        "desc": ""
    },
    "for_in_range": {
        "script": "rg = kwargs.get('repeat', 10)\nsm = 0\nfor i in range(rg):\n    sm = sm + i\nresult = sm",
        "vars": {},
        "type": "int",
        "desc": ""
    }
}